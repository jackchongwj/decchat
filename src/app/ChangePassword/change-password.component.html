<!-- src/app/ChangePassword/change-password.component.html -->

<form [formGroup]="changePasswordForm" (ngSubmit)="onSubmit()">
  <div class="form-group">
    <label for="currentPassword">Current Password: </label>
    <input type="password" formControlName="currentPassword" id="currentPassword" placeholder="Existing password" required>
    <div *ngIf="changePasswordForm.get('currentPassword')?.touched">
      <!-- Use Angular's safe navigation operator ?. to safely access errors object -->
      <small class="error" *ngIf="changePasswordForm.get('currentPassword')?.errors?.['required']">Current Password is required.</small>
    </div>
  </div>
  
  <div class="form-group">
    <label for="newPassword">New Password: </label>
    <input type="password" formControlName="newPassword" id="newPassword" placeholder="Enter new password" required>
    <div *ngIf="changePasswordForm.get('newPassword')?.touched">
      <!-- Adjustments for errors handling using ?. for safe navigation -->
      <small class="error" *ngIf="changePasswordForm.get('newPassword')?.errors?.['minLength']">Password must be at least 8 characters.</small>
      <small class="error" *ngIf="changePasswordForm.get('newPassword')?.errors?.['requiresDigit']">Password must include a digit.</small>
      <small class="error" *ngIf="changePasswordForm.get('newPassword')?.errors?.['requiresUppercase']">Password must include an uppercase letter.</small>
      <small class="error" *ngIf="changePasswordForm.get('newPassword')?.errors?.['requiresLowercase']">Password must include a lowercase letter.</small>
      <small class="error" *ngIf="changePasswordForm.get('newPassword')?.errors?.['requiresSpecialChars']">Password must include a special character.</small>
    </div>
  </div>

  <div class="form-group">
    <label for="confirmPassword">Confirm New Password:</label>
    <input type="password" formControlName="confirmPassword" id="confirmPassword" placeholder="Repeat the password" required>
    <div *ngIf="changePasswordForm.get('confirmPassword')?.touched">
      <small class="error" *ngIf="changePasswordForm.get('confirmPassword')?.errors?.['required']">Confirmation of Password is required.</small>
      <!-- Correct access to form group level errors -->
      <small class="error" *ngIf="changePasswordForm?.errors?.['passwordMismatch']">Passwords must match.</small>
    </div>
  </div>

  <div class="form-actions">
    <button type="submit" [disabled]="!changePasswordForm.valid">Confirm Change</button>
    <button type="button" (click)="goBack()">Back</button>
  </div>
</form>
