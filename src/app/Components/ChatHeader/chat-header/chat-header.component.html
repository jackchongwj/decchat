<div class="show-chat-room" *ngIf="currentChatRoom && currentChatRoom.ChatRoomName">
    <img nz-image
      width="200px"
      height="200px"
      [nzSrc]="currentChatRoom.ProfilePicture"
      alt="" class="chatprofile">
    <h1>
      {{ currentChatRoom.ChatRoomName }}

     <!-- NZ-ZORRO Kebab menu -->

      <button nz-button nz-dropdown [nzDropdownMenu]="dropdownMenu" class="dropdown-button" *ngIf="currentChatRoom.RoomType">
        <i nz-icon nzType="more" nzTheme="outline"></i>
      </button>
      <nz-dropdown-menu #dropdownMenu="nzDropdownMenu">
        <ul nz-menu>
          <li nz-menu-item (click)="toggleModal()">Group Profile</li>
          <li nz-menu-item>Delete Group</li>
          <li nz-menu-item>Add/Kick Member</li>
        </ul>
      </nz-dropdown-menu>

      <span *ngIf="IsCurrentChatUser&&!currentChatRoom.RoomType" class="typing-indicator">
        is typing<span class="dot">.</span><span class="dot">.</span><span class="dot">.</span>
      </span>
      
      <span *ngIf="IsCurrentChatUser&&currentChatRoom.RoomType" class="typing-indicator">
        Someone is typing<span class="dot">.</span><span class="dot">.</span><span class="dot">.</span>
      </span>
    </h1>

      <button class="custom-button" (click)="showModalFn()" *ngIf="currentChatRoom.RoomType == false">
        <i class="custom-icon" nz-icon nzType="user-delete">
        </i>
      </button>
    
      <!-- Modal -->
      <nz-modal [(nzVisible)]="isVisible" nzTitle="Delete Friend"
      (nzOnCancel)="handleCancel()" [nzCancelText]="'Cancel'" (nzOnOk)="handleOk()" [nzOkText]="'Confirm'">
    
        <ng-container *nzModalContent>
    
          <div class="friend-list-container">
            Unfriend this person?
          </div>
          
        </ng-container>
        <div nz-row nzGutter="16">
          <div nz-col nzSpan="12">
            <button nz-button nzType="default" (click)="handleCancel()">Cancel</button>
          </div>
          <div nz-col nzSpan="12">
            <button nz-button nzType="primary" (click)="handleOk()">Delete Friend</button>
          </div>
        </div>
      </nz-modal>
    
</div>

  <nz-modal [(nzVisible)]="showModal" nzTitle="Group Profile" (nzOnCancel)="toggleModal()">
    <ng-container *nzModalContent>
    <!-- Group Picture with Edit Icon -->
    <div class="profile-picture-overlay" >
      <nz-avatar class="modal-avatar" [nzSrc]="previewImageUrl || currentChatRoom.ProfilePicture || 'default-profile-picture-url.png'" nzSize="large" (mouseenter)="showEditIcon = true" (mouseleave)="showEditIcon = false" (click)="fileInput.click()"></nz-avatar>
      <i nz-icon nzType="edit" class="edit-icon" *ngIf="showEditIcon"></i>
      <input type="file" #fileInput (change)="onFileSelected($event)" hidden>
    </div>
    <div *ngIf="previewImageUrl" class="image-options">
      <button nz-button nzType="primary" (click)="saveProfilePicture()">✓</button>
      <button nz-button nzType="default" (click)="cancelPreview()">✕</button>
    </div>  
  
    <!-- Group Details Display -->
    <div *ngIf="currentChatRoom" class="group-details">
      <div class="group-name-edit">
        <p *ngIf="!editMode">Group Name: <span>{{ currentChatRoom.ChatRoomName }}</span>
          <button nz-button nzType="link" (click)="toggleEditMode()">
            <i nz-icon nzType="edit"></i>
          </button>
        </p>
        <ng-container *ngIf="editMode">
          <nz-input-group nzCompact>
            <input nz-input placeholder="Group Name" [(ngModel)]="currentChatRoom.ChatRoomName"/>
          </nz-input-group>
          <button nz-button nzType="primary" (click)="saveGroupName()">Save</button>
          <button nz-button nzType="default" (click)="cancelEdit()">Cancel</button>
        </ng-container>
      </div>
      <p>Created By: <span>{{ currentChatRoom.InitiatorProfileName }}</span></p>
    </div>  
    
  </ng-container>
  </nz-modal>